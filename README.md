
<!-- README.md is generated from README.Rmd. Please edit that file -->

# presentation\_to\_video: A Shiny Application

<!-- badges: start -->

<!-- badges: end -->

The `presentation_to_video` Shiny application is to enable users to
upload a PowerPoint (pptx) presentation or provide a link to a Google
Slides presentation and create a video. The video is generated by the
slides with overlaid audio. The overlaid audio is extracted as text from
the speaker notes of the PowerPoint or Google Slides document. This text
is generated as audio using a Text-to-Speech service. Currently,
`presentation_to_video` only works with the Google Text-to-Speech API
(<https://cloud.google.com/text-to-speech/>).

![](screenshot.png)<!-- -->

You should be able to run the app using:

``` r
shiny::runApp()
```

if you have the app downloaded (after adding your authentication
described below) or

``` r
shiny::runGitHub("muschellij2/presentation_to_video")
```

but that will not have the authentication needed to run the app.

## Setup

To set up the application, you need to authorize the Text-to-Speech API
(<https://cloud.google.com/text-to-speech/>). Authorization uses the
[googleLanguageR](https://github.com/ropensci/googleLanguageR) package.

Please go to <https://github.com/ropensci/googleLanguageR#installation>
and follow the steps there. You need to create a project, enable the
text-to-speech API, then get a service account credential as a JSON
file. Name this JSON file, `google_authorization.json` and put in the
directory of the application.

## Workaround for PPTX without LibreOffice

In order to create a video, we need to transform the slides into a set
of PNGs. We do this for PPTX by converting it to a PDF using
[LibreOffice](https://www.libreoffice.org/), calling the `soffice`
function. This conversion is called using the [`docxtractr`
package](https://github.com/hrbrmstr/docxtractr). When publishing to
`shinyapps.io`, you should make sure that `library(docxtractr)` is in
your code. This triggers `libreoffice` to be installed on your Shiny
application, as we have added [the dependency for
`docxtractr`](https://github.com/rstudio/shinyapps-package-dependencies/blob/master/packages/docxtractr/install).

If `libreoffice` is not installed, then we have a workaround for
converting PPTX to PDF. We upload the data to a Google Drive account,
using the [`googledrive`](https://github.com/tidyverse/googledrive)
package, downloading the converted PDF, then deleting the file from that
account. In order to do this, you need to create a token outside of the
app. To do this, you can run:

``` r
googledrive::drive_auth(cache = FALSE)
token = googledrive::drive_token()
saveRDS(token, file = "gtoken.rds")
```

where the file name of the `rds` file must be `gtoken.rds`, unless you
change `token_fil` in `libreoffice_checks.R`. You can see whether
`libreoffice` is available in the logs for the application.

## Known bugs

Uploading a `.pptx` file to `shinyapps.io` does not work, see
<https://community.rstudio.com/t/shinyapps-io-lua-errors-with-pptx/36944>.
In order to upload a `.pptx` file, you have to zip the file. For
example, if youâ€™re uploading `example.pptx`, you would zip it and upload
`example.pptx.zip` or `example.zip` where `example.pptx` would exist in
the extracted zip folder.

# Choosing Your Voice

The [`text2speech`](https://github.com/muschellij2/text2speech) package
is used for the audio generation. In order to determine what voices are
available, you can run `text2speech::tts_voices(service)`, where
`service` For example:

``` r
voices = text2speech::tts_voices(service = "google")
voices = voices[ voices$language == "English (US)", ]
voices
#>                 voice     language language_code gender service
#> NA               <NA>         <NA>          <NA>   <NA>    <NA>
#> NA.1             <NA>         <NA>          <NA>   <NA>    <NA>
#> NA.2             <NA>         <NA>          <NA>   <NA>    <NA>
#> NA.3             <NA>         <NA>          <NA>   <NA>    <NA>
#> NA.4             <NA>         <NA>          <NA>   <NA>    <NA>
#> NA.5             <NA>         <NA>          <NA>   <NA>    <NA>
#> NA.6             <NA>         <NA>          <NA>   <NA>    <NA>
#> NA.7             <NA>         <NA>          <NA>   <NA>    <NA>
#> 49   en-US-Standard-B English (US)         en-US   MALE  google
#> 50   en-US-Standard-C English (US)         en-US FEMALE  google
#> 51    en-US-Wavenet-F English (US)         en-US FEMALE  google
#> 52    en-US-Wavenet-A English (US)         en-US   MALE  google
#> 53   en-US-Standard-D English (US)         en-US   MALE  google
#> 54    en-US-Wavenet-D English (US)         en-US   MALE  google
#> 55   en-US-Standard-E English (US)         en-US FEMALE  google
#> 56    en-US-Wavenet-E English (US)         en-US FEMALE  google
#> 57    en-US-Wavenet-C English (US)         en-US FEMALE  google
#> 58    en-US-Wavenet-B English (US)         en-US   MALE  google
```

For Google, there are standard or
[`WaveNet`](https://cloud.google.com/text-to-speech/docs/wavenet) (a
neural network) voices. The WaveNet voices tend to sound more natural,
but are more expensive to render. You can hear the voices at
<https://cloud.google.com/text-to-speech/docs/voices>.

# Finding packages

Here is are any versions of packages used for the app that may not be
from
CRAN:

|                 | package         | ondiskversion | loadedversion | path                                                                           | loadedpath                                                                     | attached | is\_base | date       | source                                      | md5ok | library                                                        |
| --------------- | :-------------- | :------------ | :------------ | :----------------------------------------------------------------------------- | :----------------------------------------------------------------------------- | :------- | :------- | :--------- | :------------------------------------------ | :---- | :------------------------------------------------------------- |
| ari             | ari             | 0.3.2         | NA            | /Library/Frameworks/R.framework/Versions/3.6/Resources/library/ari             | NA                                                                             | FALSE    | FALSE    | 2019-08-13 | local                                       | NA    | /Library/Frameworks/R.framework/Versions/3.6/Resources/library |
| ariExtra        | ariExtra        | 0.2.3         | NA            | /Library/Frameworks/R.framework/Versions/3.6/Resources/library/ariExtra        | NA                                                                             | FALSE    | FALSE    | 2019-09-04 | local                                       | NA    | /Library/Frameworks/R.framework/Versions/3.6/Resources/library |
| aws.polly       | aws.polly       | 0.1.6         | NA            | /Library/Frameworks/R.framework/Versions/3.6/Resources/library/aws.polly       | NA                                                                             | FALSE    | FALSE    | 2019-08-15 | local                                       | NA    | /Library/Frameworks/R.framework/Versions/3.6/Resources/library |
| docxtractr      | docxtractr      | 0.6.2         | NA            | /Library/Frameworks/R.framework/Versions/3.6/Resources/library/docxtractr      | NA                                                                             | FALSE    | FALSE    | 2019-08-07 | Github (<hrbrmstr/docxtractr@7cb823d>)      | NA    | /Library/Frameworks/R.framework/Versions/3.6/Resources/library |
| googledrive     | googledrive     | 1.0.0         | NA            | /Library/Frameworks/R.framework/Versions/3.6/Resources/library/googledrive     | NA                                                                             | FALSE    | FALSE    | 2019-08-07 | Github (<tidyverse/googledrive@82768bd>)    | NA    | /Library/Frameworks/R.framework/Versions/3.6/Resources/library |
| googleLanguageR | googleLanguageR | 0.2.0.9001    | 0.2.0.9001    | /Library/Frameworks/R.framework/Versions/3.6/Resources/library/googleLanguageR | /Library/Frameworks/R.framework/Versions/3.6/Resources/library/googleLanguageR | TRUE     | FALSE    | 2019-08-07 | Github (<ropensci/googleLanguageR@2b4dc88>) | NA    | /Library/Frameworks/R.framework/Versions/3.6/Resources/library |
| knitr           | knitr           | 1.24.3        | 1.24.3        | /Library/Frameworks/R.framework/Versions/3.6/Resources/library/knitr           | /Library/Frameworks/R.framework/Versions/3.6/Resources/library/knitr           | FALSE    | FALSE    | 2019-08-28 | Github (<muschellij2/knitr@abcea3d>)        | NA    | /Library/Frameworks/R.framework/Versions/3.6/Resources/library |
| later           | later           | 0.8.0.9003    | NA            | /Library/Frameworks/R.framework/Versions/3.6/Resources/library/later           | NA                                                                             | FALSE    | FALSE    | 2019-08-07 | Github (<r-lib/later@ae297fa>)              | NA    | /Library/Frameworks/R.framework/Versions/3.6/Resources/library |
| mscstts         | mscstts         | 0.5.2         | NA            | /Library/Frameworks/R.framework/Versions/3.6/Resources/library/mscstts         | NA                                                                             | FALSE    | FALSE    | 2019-08-06 | Github (<muschellij2/mscstts@226bfef>)      | NA    | /Library/Frameworks/R.framework/Versions/3.6/Resources/library |
| promises        | promises        | 1.0.1.9002    | NA            | /Library/Frameworks/R.framework/Versions/3.6/Resources/library/promises        | NA                                                                             | FALSE    | FALSE    | 2019-08-07 | Github (<rstudio/promises@9ebad6d>)         | NA    | /Library/Frameworks/R.framework/Versions/3.6/Resources/library |
| text2speech     | text2speech     | 0.2.7         | 0.2.7         | /Library/Frameworks/R.framework/Versions/3.6/Resources/library/text2speech     | /Library/Frameworks/R.framework/Versions/3.6/Resources/library/text2speech     | FALSE    | FALSE    | 2019-08-15 | local                                       | NA    | /Library/Frameworks/R.framework/Versions/3.6/Resources/library |
